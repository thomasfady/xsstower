import{d as T,o as g,e as w,b as C,k as j,g as A,l as H,r as l,c as P,w as t,f as e,i as v,m as D,_ as N,F as I,j as b,p as L,a as E,h as S,z as x}from"./index-dce2ea2e.js";import{T as U}from"./TrashOutline-c76d9c2e.js";import{A as B}from"./AddCircleOutline-5f6a83c1.js";import{A as F}from"./AddOutline-6431c29d.js";import{R as M}from"./RefreshOutline-07806ad1.js";import{F as R}from"./FlashOutline-c5c258d0.js";const $={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},z=C("g",{fill:"none"},[C("path",{d:"M27.314 4.687a4 4 0 0 1 0 5.657L12.54 25.117a4.999 4.999 0 0 1-2.323 1.315l-4.582 1.146a1 1 0 0 1-1.213-1.213l1.146-4.582a5 5 0 0 1 1.315-2.323L21.657 4.687a4 4 0 0 1 5.657 0zM20.243 8.93L8.298 20.874a3 3 0 0 0-.789 1.394l-.741 2.965l2.965-.741a3.001 3.001 0 0 0 1.394-.79L23.07 11.759L20.243 8.93zM23.07 6.1l-1.414 1.415l2.828 2.828L25.9 8.93A2 2 0 0 0 23.07 6.1z",fill:"currentColor"})],-1),O=[z],V=T({name:"Edit32Regular",render:function(m,d){return g(),w("svg",$,O)}}),J={__name:"HandlersActions",props:{handler:{required:!0}},emits:["HandleDeleted"],setup(u,{emit:m}){const d=u,p=j(),_=A(),a=H();function h(){p.push("/handler/"+d.handler.ID)}function n(){_.error({title:"Delete",content:"Delete the handler "+d.handler.Domain+"/"+d.handler.Path+" ?",positiveText:"Delete",negativeText:"Not Sure",onPositiveClick:()=>{fetch("/api/handler/"+d.handler.ID,{method:"DELETE"}).then(s=>s.json()).then(s=>{m("HandleDeleted"),a.success("Handler deleted")})}})}return(s,o)=>{const r=l("n-icon"),i=l("n-button"),f=l("n-space");return g(),P(f,null,{default:t(()=>[e(i,{type:"info","icon-placement":"left",onClick:h},{icon:t(()=>[e(r,null,{default:t(()=>[e(v(V))]),_:1})]),_:1}),e(i,{type:"error","icon-placement":"left",onClick:n},{icon:t(()=>[e(r,null,{default:t(()=>[e(v(U))]),_:1})]),_:1})]),_:1})}}},q={__name:"CreateHandler",emits:["handleCreated"],setup(u,{expose:m,emit:d}){const p=D(!1),_=H(),a=D({domain:"*",path:"admin",screenshot:!0,dom:!0});function h(){p.value=!0}m({open:h});async function n(){const s=await fetch("/api/handlers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a.value)});return s.ok?(_.success("Handler created"),p.value=!1,a.value={domain:"*",path:"admin",screenshot:!0,dom:!0},d("handleCreated")):_.error(await s.json()),!1}return(s,o)=>{const r=l("n-input"),i=l("n-form-item"),f=l("n-switch"),y=l("n-form"),k=l("n-modal");return g(),P(k,{show:p.value,"onUpdate:show":o[4]||(o[4]=c=>p.value=c),"mask-closable":!1,preset:"dialog",title:"Create new handler",content:"Create","positive-text":"Confirm","negative-text":"Cancel",onPositiveClick:n},{icon:t(()=>[e(v(B))]),default:t(()=>[e(y,{vertical:""},{default:t(()=>[e(i,{label:"Domain",path:"form.domain"},{default:t(()=>[e(r,{value:a.value.domain,"onUpdate:value":o[0]||(o[0]=c=>a.value.domain=c),placeholder:"Domain"},null,8,["value"])]),_:1}),e(i,{label:"Path",path:"form.path"},{default:t(()=>[e(r,{value:a.value.path,"onUpdate:value":o[1]||(o[1]=c=>a.value.path=c),placeholder:"Path"},null,8,["value"])]),_:1}),e(i,{label:"Take Screenshot",path:"form.screenshot"},{default:t(()=>[e(f,{value:a.value.screenshot,"onUpdate:value":o[2]||(o[2]=c=>a.value.screenshot=c)},null,8,["value"])]),_:1}),e(i,{label:"Get Dom",path:"form.dom"},{default:t(()=>[e(f,{value:a.value.dom,"onUpdate:value":o[3]||(o[3]=c=>a.value.dom=c)},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["show"])}}};const G=u=>(L("data-v-f049ae1b"),u=u(),E(),u),X={style:{"justify-content":"space-between"}},K=G(()=>C("h2",null,"Handlers",-1)),Q=!1,W={__name:"Handlers",setup(u){const m=D();function d(){m.value.open()}const p=[{title:"Domain",key:"Domain"},{title:"Path",key:"Path"},{title:"Screenshot",key:"Screenshot",render(n){return S(x,{value:n.Screenshot,"on-update:value":function(){a(n,"Screenshot")}})}},{title:"Dom",key:"Dom",render(n){return S(x,{value:n.Dom,"on-update:value":function(){a(n,"Dom")}})}},{title:"Action",key:"actions",render(n){return S(J,{handler:n,onHandleDeleted:_})}}];function _(){fetch("/api/handlers").then(n=>n.json()).then(n=>{h.value=n})}function a(n,s){let o={};o.Screenshot=n.Screenshot,o.CollectedPages=n.CollectedPages,o.Dom=n.Dom,o[s]=!n[s],fetch("/api/handler/"+n.ID,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then(r=>r.json()).then(r=>{n.Screenshot=r.Screenshot,n.Dom=r.Dom})}const h=D([]);return _(),(n,s)=>{const o=l("n-icon"),r=l("n-button"),i=l("n-space"),f=l("n-empty"),y=l("n-data-table"),k=l("n-card");return g(),w(I,null,[C("header",X,[K,C("div",null,[e(i,null,{default:t(()=>[e(r,{type:"success","icon-placement":"left",onClick:s[0]||(s[0]=c=>d())},{icon:t(()=>[e(o,null,{default:t(()=>[e(v(F))]),_:1})]),default:t(()=>[b(" Add ")]),_:1}),e(r,{type:"info","icon-placement":"left",onClick:_},{icon:t(()=>[e(o,null,{default:t(()=>[e(v(M))]),_:1})]),default:t(()=>[b(" Refresh ")]),_:1})]),_:1})])]),e(k,null,{default:t(()=>[e(y,{columns:p,data:h.value,pagination:Q,bordered:!0},{empty:t(()=>[e(f,{description:"No handler. Create one to receive XSS Fires !"},{icon:t(()=>[e(o,null,{default:t(()=>[e(v(R))]),_:1})]),_:1})]),_:1},8,["data"])]),_:1}),e(q,{onHandleCreated:n.fetchHandlers,ref_key:"create",ref:m},null,8,["onHandleCreated"])],64)}}},ae=N(W,[["__scopeId","data-v-f049ae1b"]]);export{ae as default};
