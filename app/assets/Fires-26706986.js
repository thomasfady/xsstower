import{d as R,o as w,e as C,b as _,k as b,g as j,l as B,r as s,c as D,w as n,f as t,i as c,_ as E,m,s as N,F as A,j as y,v as x,t as P,p as V,a as $,h as k}from"./index-dce2ea2e.js";import{T as H}from"./TrashOutline-c76d9c2e.js";import{R as z}from"./RefreshOutline-07806ad1.js";import{T as K}from"./Terminal-14cf8be5.js";const L={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},M=_("path",{d:"M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 0 0-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 0 0 0-17.47C428.89 172.28 347.8 112 255.66 112z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),q=_("circle",{cx:"256",cy:"256",r:"80",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),O=[M,q],X=R({name:"EyeOutline",render:function(l,a){return w(),C("svg",L,O)}}),G={__name:"FiresActions",props:{hit:{required:!0}},setup(i){const l=i,a=b(),h=j(),p=B();function u(){h.error({title:"Delete",content:"Delete the hit from "+l.hit.Ip+" ?",positiveText:"Delete",negativeText:"Not Sure",onPositiveClick:()=>{fetch("/api/fire/"+l.hit.CorrelationKey,{method:"DELETE"}).then(r=>r.json()).then(r=>{fire.value=r}),p.success("Hit deleted")}})}function g(){a.push("/fire/"+l.hit.CorrelationKey)}return(r,v)=>{const e=s("n-icon"),o=s("n-button"),d=s("n-space");return w(),D(d,null,{default:n(()=>[t(o,{type:"info","icon-placement":"left",onClick:g},{icon:n(()=>[t(e,null,{default:n(()=>[t(c(X))]),_:1})]),_:1}),t(o,{type:"error","icon-placement":"left",onClick:u},{icon:n(()=>[t(e,null,{default:n(()=>[t(c(H))]),_:1})]),_:1})]),_:1})}}};const J=i=>(V("data-v-2b7ca82a"),i=i(),$(),i),Q={style:{"justify-content":"space-between"}},W=J(()=>_("h2",null,"XSS Fires",-1)),Y=!1,Z={__name:"Fires",setup(i){const l=b(),a=m(1);N(a,(e,o)=>{r()});const h=m(1),p=m(0);function u(e,o){return e.length>o?e.substring(0,o-3)+"...":e}const g=[{title:"IP",key:"Ip"},{title:"Handler",key:"Handler"},{title:"Url",key:"Url",render(e){return k("p",{},{default:()=>u(e.Url,50)})}},{title:"UserAgent",key:"UserAgent",render(e){return k("p",{},{default:()=>u(e.UserAgent,50)})}},{title:"Referer",key:"Referer"},{title:"Action",key:"actions",render(e){return k(G,{hit:e})}}];function r(){fetch("/api/fires?"+new URLSearchParams({page:a.value})).then(e=>e.json()).then(e=>{v.value=e.fires,a.value=e.page,p.value=e.total_rows,h.value=e.total_pages})}const v=m([]);return r(),(e,o)=>{const d=s("n-icon"),T=s("n-empty"),U=s("n-data-table"),F=s("n-pagination"),I=s("n-space"),S=s("n-card");return w(),C(A,null,[_("header",Q,[W,_("div",null,[t(c(x),{type:"info","icon-placement":"left",onClick:r},{icon:n(()=>[t(d,null,{default:n(()=>[t(c(z))]),_:1})]),default:n(()=>[y(" Refresh ")]),_:1})])]),t(S,null,{default:n(()=>[t(I,{vertical:""},{default:n(()=>[t(U,{columns:g,data:v.value,pagination:Y,bordered:!0},{empty:n(()=>[t(T,{description:"No fires received. Use payload on vulnerable endpoint and enjoy !"},{icon:n(()=>[t(d,null,{default:n(()=>[t(c(K))]),_:1})]),extra:n(()=>[t(c(x),{size:"small",onClick:o[0]||(o[0]=f=>c(l).push("/payloads"))},{default:n(()=>[y(" View Payloads ")]),_:1})]),_:1})]),_:1},8,["data"]),t(F,{page:a.value,"onUpdate:page":o[1]||(o[1]=f=>a.value=f),"page-size":10,"item-count":p.value},{suffix:n(({itemCount:f})=>[y(" Total items "+P(f),1)]),_:1},8,["page","item-count"])]),_:1})]),_:1})],64)}}},se=E(Z,[["__scopeId","data-v-2b7ca82a"]]);export{se as default};
